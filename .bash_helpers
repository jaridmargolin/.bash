#!/bin/bash

# ##############################################################################
#
# .bash_helpers
#
# Helper method required for imports and installation
#
# ##############################################################################

function getLinkedDir(){
  src=$1
  while [ -h $src ]; do # resolve $source until the file is no longer a symlink
    dir=$(getDir $src)
    src=$(readlink $src)
    # if $SOURCE was a relative symlink, we need to resolve it relative to the
    # path where the symlink file was located
    [[ $src != /* ]] && src=$dir/$src
  done
  dir=$(getDir $src)
  echo $dir
}

function getDir(){
  echo $(builtin cd "$(dirname $1)" && pwd)
}

function getSiblings(){
  echo $(ls $2/$3 | grep -v $1)
}

function runSiblings(){
  SRC_DIR="$(getLinkedDir $1)"
  for FILE in $(getSiblings $1 $SRC_DIR "$2"); do
    . $FILE
  done
}
